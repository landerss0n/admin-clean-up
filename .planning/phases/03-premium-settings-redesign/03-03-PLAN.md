---
phase: 03-premium-settings-redesign
plan: 03
type: execute
wave: 3
depends_on: [03-02]
files_modified: [includes/class-admin-page.php, assets/css/admin.css]
autonomous: false

must_haves:
  truths:
    - "Notices tab renders 4 toggles inside a card (no form-table)"
    - "Media tab renders 1 toggle + 1 radio group inside a card"
    - "Plugin Cleanup tab renders toggle(s) inside a card for each installed plugin"
    - "Updates tab renders 1 radio group + 4 toggles inside cards"
    - "No form-table markup remains anywhere in class-admin-page.php"
    - "Settings page visually renders as premium dark UI (verified by user)"
  artifacts:
    - path: "includes/class-admin-page.php"
      provides: "All 9 tabs migrated to component-based rendering"
      contains: "render_radio_group"
    - path: "assets/css/admin.css"
      provides: "Menu item specific styles added"
      contains: "acu-menu-item"
  key_links:
    - from: "includes/class-admin-page.php"
      to: "includes/class-components.php"
      via: "Component render calls for all tab types"
      pattern: "WP_Clean_Up_Components::render_(card|toggle|setting_group|radio_group|text_input|select)"
---

<objective>
Complete the remaining 4 tab migrations (Notices, Media, Plugin Cleanup, Updates) and add final CSS adjustments. After this plan, ALL 9 tabs render using the component library with no form-table markup remaining. Includes a human verification checkpoint to confirm the dark UI renders correctly.

Purpose: Completes the full tab migration (all 9 tabs done) and gets user confirmation that the premium dark UI looks correct.
Output: Fully migrated settings page with all tabs using component architecture, verified visually by user.
</objective>

<execution_context>
@/Users/lucas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/lucas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-premium-settings-redesign/03-CONTEXT.md
@.planning/phases/02-ui-architecture/02-02-SUMMARY.md

@includes/class-admin-page.php
@includes/class-components.php
@assets/css/admin.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Notices, Media, Plugin Cleanup, and Updates tabs</name>
  <files>includes/class-admin-page.php, assets/css/admin.css</files>
  <action>
**Replace `render_notices_tab()` method body:**

The Notices tab has 4 simple toggles. Use one card with a setting group:

```php
private function render_notices_tab( $options ) {
    $notices = isset( $options['notices'] ) ? $options['notices'] : [];

    ob_start();
    WP_Clean_Up_Components::render_setting_group( [
        'settings' => [
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[notices][hide_update_notices]',
                'checked'     => ! empty( $notices['hide_update_notices'] ),
                'label'       => __( 'Hide Update Notices', 'admin-clean-up' ),
                'description' => __( 'Hides notices about WordPress, plugin and theme updates.', 'admin-clean-up' ),
            ],
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[notices][hide_all_notices]',
                'checked'     => ! empty( $notices['hide_all_notices'] ),
                'label'       => __( 'Hide All Admin Notices', 'admin-clean-up' ),
                'description' => __( 'Warning: This hides ALL notices, including important error messages and warnings.', 'admin-clean-up' ),
            ],
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[notices][hide_screen_options]',
                'checked'     => ! empty( $notices['hide_screen_options'] ),
                'label'       => __( 'Hide Screen Options Tab', 'admin-clean-up' ),
            ],
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[notices][hide_help_tab]',
                'checked'     => ! empty( $notices['hide_help_tab'] ),
                'label'       => __( 'Hide Help Tab', 'admin-clean-up' ),
            ],
        ],
    ] );
    $content = ob_get_clean();

    WP_Clean_Up_Components::render_card( [
        'title'       => __( 'Notices & UI Elements', 'admin-clean-up' ),
        'description' => __( 'Control which notices and interface elements are displayed in admin.', 'admin-clean-up' ),
        'content'     => $content,
    ] );
}
```

**Replace `render_media_tab()` method body:**

The Media tab has 1 toggle (clean_filenames) + 1 radio group (clean_filenames_types). Use one card:

```php
private function render_media_tab( $options ) {
    $media = isset( $options['media'] ) ? $options['media'] : [];

    ob_start();
    WP_Clean_Up_Components::render_toggle( [
        'name'        => WP_Clean_Up::OPTION_KEY . '[media][clean_filenames]',
        'checked'     => ! empty( $media['clean_filenames'] ),
        'label'       => __( 'Clean Filenames on Upload', 'admin-clean-up' ),
        'description' => __( 'Converts special characters to ASCII, replaces spaces with dashes, removes accents, and converts to lowercase. Original title preserved in media library.', 'admin-clean-up' ),
    ] );
    WP_Clean_Up_Components::render_radio_group( [
        'name'    => WP_Clean_Up::OPTION_KEY . '[media][clean_filenames_types]',
        'value'   => $media['clean_filenames_types'] ?? 'all',
        'options' => [
            [
                'value' => 'all',
                'label' => __( 'All file types', 'admin-clean-up' ),
            ],
            [
                'value' => 'images',
                'label' => __( 'Images only', 'admin-clean-up' ),
                'description' => __( 'JPG, PNG, GIF, WebP, etc.', 'admin-clean-up' ),
            ],
        ],
    ] );
    $content = ob_get_clean();

    WP_Clean_Up_Components::render_card( [
        'title'       => __( 'Media Library', 'admin-clean-up' ),
        'description' => __( 'Settings for file uploads and the media library.', 'admin-clean-up' ),
        'content'     => $content,
    ] );
}
```

**Replace `render_plugins_tab()` method body:**

The Plugins tab iterates over installed supported plugins and renders a toggle for each. The structure is already extensible (array-driven). Use one card per plugin (or one card with a setting group if multiple):

```php
private function render_plugins_tab( $options ) {
    $plugins = isset( $options['plugins'] ) ? $options['plugins'] : [];
    $installed_plugins = $this->get_installed_supported_plugins();

    $plugin_descriptions = [
        'pixelyoursite' => __( 'Hides the "Free PIXELYOURSITE HACKS" email signup, video tips, and other promotional notices.', 'admin-clean-up' ),
    ];

    $plugin_labels = [
        'pixelyoursite' => __( 'Hide PixelYourSite Promotional Notices', 'admin-clean-up' ),
    ];

    ob_start();
    foreach ( $installed_plugins as $key => $plugin ) {
        WP_Clean_Up_Components::render_toggle( [
            'name'        => WP_Clean_Up::OPTION_KEY . '[plugins][' . $plugin['option'] . ']',
            'checked'     => ! empty( $plugins[ $plugin['option'] ] ),
            'label'       => $plugin_labels[ $key ] ?? sprintf( __( 'Hide %s notices', 'admin-clean-up' ), $plugin['name'] ),
            'description' => $plugin_descriptions[ $key ] ?? '',
        ] );
    }
    $content = ob_get_clean();

    WP_Clean_Up_Components::render_card( [
        'title'       => __( 'Plugin Cleanup', 'admin-clean-up' ),
        'description' => __( 'Hide promotional notices and nag screens from specific plugins.', 'admin-clean-up' ),
        'content'     => $content,
    ] );
}
```

**Replace `render_updates_tab()` method body:**

The Updates tab has: 1 radio group (core_updates with 5 options) + 4 toggles (plugin updates, theme updates, emails, nags). Use two cards: "Core Updates" and "Auto-Update Controls":

```php
private function render_updates_tab( $options ) {
    $updates = isset( $options['updates'] ) ? $options['updates'] : [];

    // Card 1: Core Updates (radio group)
    ob_start();
    WP_Clean_Up_Components::render_radio_group( [
        'name'    => WP_Clean_Up::OPTION_KEY . '[updates][core_updates]',
        'value'   => $updates['core_updates'] ?? 'default',
        'options' => [
            [
                'value' => 'default',
                'label' => __( 'WordPress Default', 'admin-clean-up' ),
                'description' => __( 'Minor updates only (recommended)', 'admin-clean-up' ),
            ],
            [
                'value' => 'security_only',
                'label' => __( 'Security Updates Only', 'admin-clean-up' ),
            ],
            [
                'value' => 'minor_only',
                'label' => __( 'Minor Updates Only', 'admin-clean-up' ),
                'description' => __( 'E.g., 6.4.1 to 6.4.2', 'admin-clean-up' ),
            ],
            [
                'value' => 'all_updates',
                'label' => __( 'All Updates', 'admin-clean-up' ),
                'description' => __( 'Major + minor (e.g., 6.4 to 6.5)', 'admin-clean-up' ),
            ],
            [
                'value' => 'disable_all',
                'label' => __( 'Disable All Core Updates', 'admin-clean-up' ),
            ],
        ],
    ] );
    $content1 = ob_get_clean();

    WP_Clean_Up_Components::render_card( [
        'title'       => __( 'WordPress Core Updates', 'admin-clean-up' ),
        'description' => __( 'Control automatic update behavior for WordPress core.', 'admin-clean-up' ),
        'content'     => $content1,
    ] );

    // Card 2: Auto-Update Controls (toggles)
    ob_start();
    WP_Clean_Up_Components::render_setting_group( [
        'settings' => [
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[updates][disable_plugin_updates]',
                'checked'     => ! empty( $updates['disable_plugin_updates'] ),
                'label'       => __( 'Disable Plugin Auto-Updates', 'admin-clean-up' ),
                'description' => __( 'Prevents plugins from updating automatically. Manual updates still available.', 'admin-clean-up' ),
            ],
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[updates][disable_theme_updates]',
                'checked'     => ! empty( $updates['disable_theme_updates'] ),
                'label'       => __( 'Disable Theme Auto-Updates', 'admin-clean-up' ),
                'description' => __( 'Prevents themes from updating automatically. Manual updates still available.', 'admin-clean-up' ),
            ],
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[updates][disable_update_emails]',
                'checked'     => ! empty( $updates['disable_update_emails'] ),
                'label'       => __( 'Disable Update Emails', 'admin-clean-up' ),
                'description' => __( 'Stops WordPress from sending emails about automatic updates.', 'admin-clean-up' ),
            ],
            [
                'name'        => WP_Clean_Up::OPTION_KEY . '[updates][hide_update_nags]',
                'checked'     => ! empty( $updates['hide_update_nags'] ),
                'label'       => __( 'Hide Update Nags', 'admin-clean-up' ),
                'description' => __( 'Hides "WordPress X.X is available!" messages and update count badges.', 'admin-clean-up' ),
            ],
        ],
    ] );
    $content2 = ob_get_clean();

    WP_Clean_Up_Components::render_card( [
        'title'       => __( 'Auto-Update Controls', 'admin-clean-up' ),
        'content'     => $content2,
    ] );
}
```

**Also add to admin.css** the `.acu-menu-item` styles that Plan 03-02 needs for the Menus tab (since this plan runs after 03-02 and has admin.css in its files_modified):

```css
/* Menu item component (Menus tab specific) */
.acu-menu-item {
    padding: 12px 0;
    border-bottom: 1px solid var(--acu-dark-border);
}

.acu-menu-item:last-child {
    border-bottom: none;
}

.acu-menu-item .acu-select {
    margin-top: 8px;
    margin-left: 60px;
}

.acu-menu-item .acu-text-warning {
    margin: 8px 0 0 60px;
    font-size: 12px;
    color: var(--acu-dark-accent-warning, #FFB74D);
}
```

Wait — plan 03-02 renders the menus tab with an inline `<style>` block. So this CSS is only needed if we want to remove that inline style. Since plan 03-02 already handles it with inline styles, skip adding to admin.css here. Instead, just add the menu-item CSS to admin.css to be cleaner (remove the inline style approach from 03-02's output). Actually, since 03-02 runs before 03-03 and 03-02's inline approach is self-contained, and we have admin.css in our files_modified, let's add the `.acu-menu-item` styles to admin.css here and then update render_menus_tab to remove the inline `<style>` block if it exists.

Actually to keep things simpler: Plan 03-02 will write its inline `<style>`. Plan 03-03 moves those styles to admin.css and removes the inline block. This is cleaner since admin.css is already in our files_modified list.

So: After migrating the 4 tabs, also:
1. Append `.acu-menu-item` styles to end of admin.css
2. Remove the inline `<style>` block from render_menus_tab() if present (the CSS now lives in admin.css)

CRITICAL: All field names must match originals exactly for backwards-compatible save/load.
  </action>
  <verify>
    - `php -l includes/class-admin-page.php` returns no syntax errors
    - `grep -c "form-table" includes/class-admin-page.php` returns 0
    - grep for "render_radio_group" returns matches in render_media_tab and render_updates_tab
    - grep for "render_toggle" returns matches in all 4 new tab methods
    - grep for "render_card" returns matches in all 4 new tab methods
    - All notices field names preserved: hide_update_notices, hide_all_notices, hide_screen_options, hide_help_tab
    - All media field names preserved: clean_filenames, clean_filenames_types
    - Plugins field name preserved: hide_pixelyoursite_notices
    - All updates field names preserved: core_updates, disable_plugin_updates, disable_theme_updates, disable_update_emails, hide_update_nags
    - grep for "acu-menu-item" in admin.css returns matches
  </verify>
  <done>All 9 tabs migrated to component-based rendering. Zero form-table markup in class-admin-page.php. Menu item CSS moved to admin.css. All field names backwards compatible.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete premium dark UI settings page with all 9 tabs migrated to card/toggle components. Dark theme (#121212 base), premium sidebar navigation, elevated card surfaces (#1E1E1E), toggle switches with accent color, radio groups, text inputs, and save button — all styled for a Stripe Dashboard / Linear inspired look.</what-built>
  <how-to-verify>
    1. Sync the plugin to the test site:
       ```
       rsync -av --delete "/Users/lucas/Sites/admin-clean-up/" "/Users/lucas/Local Sites/testar-plugins/app/public/wp-content/plugins/admin-clean-up/" --exclude='.planning' --exclude='.git'
       ```
    2. Visit the Admin Clean Up settings page in WordPress admin (Settings → Admin Clean Up)
    3. Verify the dark UI renders as an island inside WordPress admin
    4. Check each tab:
       - Admin Bar: 1 card with 5 toggles
       - Comments: 1 card with 1 toggle
       - Dashboard: 1 card with 2 groups (Widgets + Site Health)
       - Admin Menus: 1 card with toggle+select pairs, select enables/disables
       - Footer: 2 cards with toggle+text input
       - Notices: 1 card with 4 toggles
       - Media: 1 card with toggle+radio group
       - Updates: 2 cards (core radio group + 4 toggles)
       - Plugin Cleanup (only visible if PixelYourSite Free active)
    5. Toggle some settings and save — verify settings persist
    6. Check mobile view at 782px width (dev tools) — sidebar becomes horizontal tabs
    7. Keyboard navigate (Tab + Space) — verify focus indicators visible
  </how-to-verify>
  <resume-signal>Type "approved" if it looks good, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
After all tasks and approval:
1. `grep -c "form-table" includes/class-admin-page.php` — Returns 0
2. `grep -c "WP_Clean_Up_Components::" includes/class-admin-page.php` — Returns 20+ matches
3. All 9 tab methods use component library exclusively
4. User has visually confirmed the dark UI renders correctly
5. Settings save and load correctly after migration
</verification>

<success_criteria>
- All 9 settings tabs display as card-based layouts with toggle switches
- No form-table markup remains in rendered settings output
- Saving settings on any tab preserves all values correctly
- Mobile layout at 782px transforms sidebar to horizontal tabs
- Visual hierarchy is clear: cards grouped, labels readable, descriptions subordinate
- User has approved the visual appearance
</success_criteria>

<output>
After completion, create `.planning/phases/03-premium-settings-redesign/03-03-SUMMARY.md`
</output>
